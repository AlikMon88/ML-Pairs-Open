## Introduction

Nowadays, we seem to be in the “big data” era, and [machine learning algorithms frequently put simpler statistical methods to the side](https://quantpedia.com/the-cape-ratio-and-machine-learning/). While linear regression was the work-horse for the predictions in the past, more advanced techniques such as regularized regressions, neural networks or decision trees (forests) are being used. As a result, the widely recognized strategies and anomalies are being revisited, and with a variable success rate, are [improved using novel machine learning (ML) methods](https://quantpedia.com/man-vs-machine-stock-analysis/). The novel research studies the possible impact of utilizing ML methods for a popular statistical arbitrage strategy – pairs trading. Traditionally, pairs trading was based on the idea that when two assets have historically co-moved, a mean-reversion should be expected once they have diverged. Usually, time-series analysis and cointegration tests are used to find the pairs employed in the pairs trading. The novel idea of the paper is that the co-movement in returns might be improved by taking into account numerous stocks’ characteristics. Moreover, the whole strategy is based on an [unsupervised machine learning method – clustering](https://quantpedia.com/introduction-to-clustering-methods-in-portfolio-management-part-1/). The algorithm based on 48 momentum signals and 78 firm characteristics is utilized to find optimal clusters or groups of stocks that should co-move together. The strategy then identifies the past one-month’s underperformers and outperforms and essentially employs a contrarian approach because it bets on past losers and the mean-reversion: past winners will underperform, and past losers will outperform. Lastly, several clustering algorithms are utilized in the paper. Still, the agglomerative clustering seems to work the best in the case of stock clusters compared to the k-means that suffers from outliers being clustered to “unrelated” groups or DBSCAN based on density and creates one big cluster. Therefore, the presented strategy is based on agglomerative clustering (hierarchical “bottom-up” approach – starting with individual clusters).

## Fundamental reason

Pairs trading is based on the idea that if the spread between stocks that have historically moved together widens, it is a trading opportunity since history tends to repeat itself. It is expected that the gap would close. Therefore, a mean-reversion is expected: past winners will underperform, and past losers will outperform. The functionality is based on this classical statistical arbitrage strategy, but the design can also identify the “pairs” much better. Data suggests that not relying only on the past returns but also incorporating the firm characteristics improves returns of such strategy. Additionally, similar groups are found by unsupervised machine learning algorithms that do not suffer from overfitting and are highly transparent – the clustering or the “division” into groups is based on the distance between clusters. To sum it up, the outperformance over the traditional pairs trading is based on the addition of firm characteristics that helps to identify the stocks that co-move together.
Moreover, the strategy remains highly significant even if transaction costs are included, not driven by common risk factors, and robust to excluding small stocks.

## High-Level Understanding (Strategy)

The investment universe consists of common shares listed on NYSE, AMEX or NASDAQ with a valid price and returns history of at least four years. The features for clustering (unsupervised learning) consist of 48 momentum signals (month t-2 to month t-48) and 78 firm characteristics of Green et al. (2017) (Appendix A). Features are cross-sectionally standardized, and the dimensionality is reduced using PCA such that principal components explain at least 99% of the variation. The principal components are used each month in the agglomerative clustering (section 3.2.3), and the average linkage distance with l1 metric is used to create clusters. The number of clusters is not pre-defined, but it is based on the maximum distance for clusters to be merged which is the 30th percentile of the distances between a pair of nearest data points. The authors chose the hyperparameter since it has achieved the highest Sharpe ratio (authors considered 10-90th percentiles) – this could be subject to change when another dataset is used. Alternatively, it is possible to pre-define the number of clusters or pick the clusters based on other methods. When stocks are assigned to clusters, compute the past one month´s return and pair the stock with the highest return with stock with the lowest return (the second highest with the second lowest and so on). For each pair, if the difference of the returns is greater than the cross-sectional standard deviation of all pairs, go long the stock with the low return and short stock with the high return. The strategy is rebalanced monthly and equally weighted.

## Source paper

**Han, Chulwoo and He, Zhaodong and Toh, Alenson Jun Wei: Pairs Trading via Unsupervised Learning**

https://ssrn.com/abstract=3835692

**Abstract**

This paper develops a pairs trading strategy via unsupervised learning. Unlike conventional pairs trading strategies that identify pairs based on return time series, we identify pairs by incorporating firm characteristics as well as price information. Firm characteristics are revealed to provide important information for pair identification and significantly improve the performance of the pairs trading strategy. Applied to the US stock market from January 1980 to December 2020, the long-short portfolio constructed via the agglomerative clustering earns a statistically significant annualized mean return of 24.8% and a Sharpe ratio of 2.69. The strategy remains profitable after accounting for transaction costs and removing stocks below 20% NYSE-size quantile. A host of robustness tests confirm that the results are not driven by data snooping.

